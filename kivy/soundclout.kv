#: kivy 1.10.0
#: import hex kivy.utils.get_color_from_hex
#: import main soundclout
#: import ListAdapter kivy.adapters.listadapter.ListAdapter
#: import ListItemButton kivy.uix.listview.ListItemButton

<HomeScreen>:
    rows: 2
    spacing: 10
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        size_hint_y: None
        height: 50
        spacing: 10
        pos: root.x, (root.height-50)
 
        # Make the background for the toolbar blue
        canvas:
            Color:
                rgba: hex('#0099cc')
            Rectangle:
                pos: self.pos
                size: self.size
        Button:
        	on_press: root.manager.current = 'homescreen_1'
            background_normal: 'icons/home.png'
            size_hint_x: None
            width:50

    BoxLayout:
        size_hint_y: None
        height: 500
        spacing: 50
        padding: 50
        pos: root.x, (root.height-560)

        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size

        	Button:
            	text: "Start"
				font_size: 20
				on_press: root.manager.current = 'runscreen_2'

        	Button:
            	text: "Device Tester"
				font_size: 20
				on_press: root.manager.current = 'device_tester_screen_3'

        	Button:
            	text: "Connect Devices"
				font_size: 20
				on_press: root.manager.current = 'connect_devices_screen_4'

        	Button:
            	text: "Edit Device Groups"
				font_size: 20
				on_press: root.manager.current = 'edit_device_groups_screen_5'

        	Button:
            	text: "Edit Group Behavior"
				font_size: 20
				on_press: root.manager.current = str(root.skipBuild)
				on_release: root.skip_build_screen(1)

        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size
    		Label:
				text: "Connected Devices"
				font_size: 30

<RunScreen>:
    rows: 2
    spacing: 10
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        size_hint_y: None
        height: 50
        spacing: 10
        pos: root.x, (root.height-50)
 
        # Make the background for the toolbar blue
        canvas:
            Color:
                rgba: hex('#0099cc')
            Rectangle:
                pos: self.pos
                size: self.size
        Button:
        	on_press: root.manager.current = 'homescreen_1'
            background_normal: 'icons/home.png'
            size_hint_x: None
            width:50

    BoxLayout:
        size_hint_y: None
        height: 500
        spacing: 50
        padding: 50
        pos: root.x, (root.height-560)

        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size
    		Label:
				text: "Cycle Running"
				font_size: 30

<DeviceTesterScreen>:
	connected_device_list : connected_device_list_view

    rows: 2
    spacing: 10
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        size_hint_y: None
        height: 50
        spacing: 10
        pos: root.x, (root.height-50)
 
        # Make the background for the toolbar blue
        canvas:
            Color:
                rgba: hex('#0099cc')
            Rectangle:
                pos: self.pos
                size: self.size
        Button:
        	on_press: root.manager.current = 'homescreen_1'
            background_normal: 'icons/home.png'
            size_hint_x: None
            width:50

    BoxLayout:
        size_hint_y: None
        height: 500
        spacing: 50
        padding: 50
        pos: root.x, (root.height-560)

        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size
			BoxLayout:
    			orientation: "vertical"
        		
        		Button:
            		text: "Refresh List"
            		on_press: root.refresh_devices_list()
					font_size: 20
					height: 100        		

        		Button:
            		text: "Test Device"
					font_size: 20
					height: 100
			
		    BoxLayout:
		    	orientation: "horizontal"
		        canvas:
            		Color:
                		rgba: hex('#ffffff')
            		Rectangle:
                		pos: self.pos
                		size: self.size

			    ListView:
			        id: connected_device_list_view
			        adapter:
			            ListAdapter(data=main.ConnectDevicesScreen.applied_list, cls=main.DeviceListButton)


        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size
    		Label:
				text: "Device Information"
				font_size: 30

<ConnectDevicesScreen>:
	device_list:device_list_view
	connected_device_list : connected_device_list_view

    rows: 2
    spacing: 10
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        size_hint_y: None
        height: 50
        spacing: 10
        pos: root.x, (root.height-50)
 
        # Make the background for the toolbar blue
        canvas:
            Color:
                rgba: hex('#0099cc')
            Rectangle:
                pos: self.pos
                size: self.size
        Button:
        	on_press: root.manager.current = 'homescreen_1'
            background_normal: 'icons/home.png'
            size_hint_x: None
            width:50

    BoxLayout:
        size_hint_y: None
        height: 500
        spacing: 50
        padding: 50
        pos: root.x, (root.height-560)

        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size

			BoxLayout:
			    orientation: "horizontal"
			    spacing: 10
			    padding: 10
			    canvas:
			        Color:
			            rgba: hex('#0099cc')
			        Rectangle:
			            pos: self.pos
			            size: self.size

			    Button:
            		text: "Scan"
					font_size: 20
					height: 100

			    Button:
            		text: "Connect"
            		on_press: root.connect_device()
					font_size: 20
					height: 100
		    
		    BoxLayout:
		    	orientation: "horizontal"
		        canvas:
            		Color:
                		rgba: hex('#ffffff')
            		Rectangle:
                		pos: self.pos
                		size: self.size

			    ListView:
			        id: device_list_view
			        adapter:
			            ListAdapter(data=root.scan_list, cls=main.DeviceListButton)


        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size

		    BoxLayout:
		    	orientation: "horizontal"
		        canvas:
            		Color:
                		rgba: hex('#ffffff')
            		Rectangle:
                		pos: self.pos
                		size: self.size

			    ListView:
			        id: connected_device_list_view
			        adapter:
			            ListAdapter(data=root.applied_list, cls=main.DeviceListButton)

			BoxLayout:
			    orientation: "horizontal"
			    spacing: 10
			    padding: 10
			    canvas:
			        Color:
			            rgba: hex('#0099cc')
			        Rectangle:
			            pos: self.pos
			            size: self.size

			    Button:
            		text: "Disconnect Device"
					on_press: root.disconnect_device()
					font_size: 20
					height: 100

<EditDeviceGroupsScreen>:
    rows: 2
    spacing: 10
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        size_hint_y: None
        height: 50
        spacing: 10
        pos: root.x, (root.height-50)
 
        # Make the background for the toolbar blue
        canvas:
            Color:
                rgba: hex('#0099cc')
            Rectangle:
                pos: self.pos
                size: self.size
        Button:
        	on_press: root.manager.current = 'homescreen_1'
            background_normal: 'icons/home.png'
            size_hint_x: None
            width:50

    BoxLayout:
        size_hint_y: None
        height: 500
        spacing: 50
        padding: 50
        pos: root.x, (root.height-560)

        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size
			
			Label:
				text: "Device List"
				font_size: 30

        	Button:
            	text: "Group Menu"
				font_size: 20
				height: 100

        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size
    		Label:
				text: "Device Information"
				font_size: 30

<BuildTimelineScreen>:
    rows: 2
    spacing: 10
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        size_hint_y: None
        height: 50
        spacing: 10
        pos: root.x, (root.height-50)
 
        # Make the background for the toolbar blue
        canvas:
            Color:
                rgba: hex('#0099cc')
            Rectangle:
                pos: self.pos
                size: self.size
        Button:
        	on_press: root.manager.current = 'homescreen_1'
            background_normal: 'icons/home.png'
            size_hint_x: None
            width:50

    BoxLayout:
        size_hint_y: None
        height: 500
        spacing: 50
        padding: 50
        pos: root.x, (root.height-560)

        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size
    		Button:
				text: "Build Timeline"
				on_press: root.manager.current = 'edit_timeline_screen_7'
				font_size: 30

			Button:
				text: "Load Timeline"
				font_size: 30

<EditTimelineScreen>:
    rows: 2
    spacing: 10
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size

    #ToolBar
    BoxLayout:
        size_hint_y: None
        height: 50
        spacing: 10
        pos: root.x, (root.height-50)
 
        # Make the background for the toolbar blue
        canvas:
            Color:
                rgba: hex('#0099cc')
            Rectangle:
                pos: self.pos
                size: self.size
        Button:
        	on_press: root.manager.current = 'homescreen_1'
            background_normal: 'icons/home.png'
            size_hint_x: None
            width:50

    BoxLayout:
        size_hint_y: None
        height: 500
        spacing: 50
        padding: 20
        pos: root.x, (root.height-560)

        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size
   
	        Button:
	            size_hint_x: None
	            size_hint_y: None
	            height: 50
	            width:100
	        	text: 'New Table'
				on_press: root.manager.current = 'build_timeline_screen_6'

    		BoxLayout:
        		orientation: "vertical"
        		spacing: 5
        		padding: 5
	        	canvas:
	            	Color:
	                	rgba: hex('#ffffff')
	            	Rectangle:
	                	pos: self.pos
	                	size: self.size

	            #Group One
	    		BoxLayout:
	    			size_hint_y: None
	        		height:
	        		spacing: 5
	        		padding: 5  
		        	canvas:
		            	Color:
		                	rgba: hex('#ffffff')
		            	Rectangle:
		                	pos: self.pos
		                	size: self.size

		    		BoxLayout:
				        size_hint_x: None
				        width: 200
			        	canvas:
			            	Color:
			                	rgba: hex('#98a6b3')
			            	Rectangle:
			                	pos: self.pos
			                	size: self.size      
			            Label:
			            	font_size: 30
			            	text: 'Group 1'
		           
		            GridLayout:
		            	rows: 2
		            	cols: 6
		        		spacing: 5
		        		padding: 5 		            	
			        	canvas:
			            	Color:
			                	rgba: hex('#0099cc')
			            	Rectangle:
			                	pos: self.pos
			                	size: self.size
						
						Button:
							text: "1"
							on_press:root.group_modification(1,1)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'
						
						Button:
							text: "2"
							on_press:root.group_modification(1,2)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'
						
						Button:
							text: "3"
							on_press:root.group_modification(1,3)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'
						
						Button:
							text: "4"
							on_press:root.group_modification(1,4)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'
						
						Button:
							text: "5"
							on_press:root.group_modification(1,5)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'
						
						Button:
							text: "6"
							on_press:root.group_modification(1,6)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'
						
						Button:
							text: "7"
							on_press:root.group_modification(1,7)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'
						
						Button:
							text: "8"
							on_press:root.group_modification(1,8)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'
						
						Button:
							text: "9"
							on_press:root.group_modification(1,9)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'
						
						Button:
							text: "10"
							on_press:root.group_modification(1,10)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'
						
						Button:
							text: "11"
							on_press:root.group_modification(1,11)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'
						
						Button:
							text: "12"
							on_press:root.group_modification(1,12)
							on_release: root.manager.current = 'edit_group_behaviour_screen_8'

<EditGroupBehaviourScreen>:
    rows: 2
    spacing: 10
    canvas:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        size_hint_y: None
        height: 50
        spacing: 10
        pos: root.x, (root.height-50)
 
        # Make the background for the toolbar blue
        canvas:
            Color:
                rgba: hex('#0099cc')
            Rectangle:
                pos: self.pos
                size: self.size
        Button:
        	on_press: root.manager.current = 'homescreen_1'
            background_normal: 'icons/home.png'
            size_hint_x: None
            width:50

    BoxLayout:
        size_hint_y: None
        height: 500
        spacing: 50
        padding: 20
        pos: root.x, (root.height-560)

        BoxLayout:
    		orientation: "vertical"
        	spacing: 10
        	padding: 10
        	canvas:
            	Color:
                	rgba: hex('#0099cc')
            	Rectangle:
                	pos: self.pos
                	size: self.size
   
	        Button:
	            size_hint_x: None
	            size_hint_y: None
	            height: 50
	            width:100
	        	text: 'Back'
	        	on_press: root.back_out()
				on_release: root.manager.current = 'edit_timeline_screen_7'

    		BoxLayout:
        		orientation: "horizontal"
        		spacing: 10
        		padding: 10
	        	canvas:
	            	Color:
	                	rgba: hex('#ffffff')
	            	Rectangle:
	                	pos: self.pos
	                	size: self.size

	    		BoxLayout:
	        		orientation: "vertical"
	        		spacing: 5
	        		padding: 5
		        	canvas:
		            	Color:
		                	rgba: hex('#ffffff')
		            	Rectangle:
		                	pos: self.pos
		                	size: self.size

		            BoxLayout:
		            	orientation: "horizontal"
			        	canvas:
			            	Color:
			                	rgba: hex('#98a6b3')
			            	Rectangle:
			                	pos: self.pos
			                	size: self.size

			            Label:
			                text: 'Activate'
			                font_size: 24

			            Switch:
			                id: switch_id
			                on_active: root.switch_on(self.active)

		            BoxLayout:
		            	orientation: "horizontal"
			        	canvas:
			            	Color:
			                	rgba: hex('#98a6b3')
			            	Rectangle:
			                	pos: self.pos
			                	size: self.size

			            Label:
			                text: str(int(slider_id.value)) + ' Events'
			                font_size: 24

			            Slider:
			                id: slider_id
			                min: 0
			                max: 100
			                value: 0
			                step: 1


	    		BoxLayout:
	        		orientation: "vertical"
	        		spacing: 5
	        		padding: 5
	            	size_hint_x: None		        	
		        	width:250
		        	canvas:
		            	Color:
		                	rgba: hex('#0099cc')
		            	Rectangle:
		                	pos: self.pos
		                	size: self.size

		            Label:
		            	text: 'Specific Events'
		            	font_size: 30

		            Label:
		            	font_size: 20

<Manager>:
	id: screen_manager
	home_screen: home_screen
	run_screen: run_screen
	device_tester_screen: device_tester_screen
	connect_devices_screen: connect_devices_screen
	edit_device_groups_screen: edit_device_groups_screen
	build_timeline_screen: build_timeline_screen
	edit_timeline_screen: edit_timeline_screen
	edit_group_behaviour_screen: edit_group_behaviour_screen

	HomeScreen:
		id: home_screen
		name: 'homescreen_1'
		manager: screen_manager

	RunScreen:
		id: run_screen
		name: 'runscreen_2'
		manager: screen_manager
	
	DeviceTesterScreen:
		id: device_tester_screen
		name: 'device_tester_screen_3'
		manager: screen_manager

	ConnectDevicesScreen:
		id: connect_devices_screen
		name: 'connect_devices_screen_4'
		manager: screen_manager

	EditDeviceGroupsScreen:
		id: edit_device_groups_screen
		name: 'edit_device_groups_screen_5'
		manager: screen_manager

	BuildTimelineScreen:
		id: build_timeline_screen
		name: 'build_timeline_screen_6'
		manager: screen_manager

	EditTimelineScreen:
		id: edit_timeline_screen
		name: 'edit_timeline_screen_7'
		manager: screen_manager
	
	EditGroupBehaviourScreen:
		id: edit_group_behaviour_screen
		name: 'edit_group_behaviour_screen_8'
		manager: screen_manager